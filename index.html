<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#f4ebe0">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" sizes="192x192" href="assets/icon-192.png">
  <link rel="apple-touch-icon" href="assets/icon-192.png">
  <title>Recipe Box Vault</title>
  <link rel="stylesheet" href="css/styles.css">
  <meta name="description" content="A cozy recipe box that hides an encrypted collection of your favorite video links behind a secret password.">
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <div class="brand-art" id="recipeBoxTheme" aria-hidden="true">
        <div class="box-lid"></div>
        <div class="box-body"></div>
        <div class="box-label">Recipe Box</div>
        <button class="secret-pad pad-left" data-step="left" aria-label="Tap the left hinge"></button>
        <button class="secret-pad pad-right" data-step="right" aria-label="Tap the right hinge"></button>
        <button class="secret-pad pad-center" data-step="center" aria-label="Tap the brass label"></button>
      </div>
      <div class="brand-copy">
        <h1>Recipe Box Vault</h1>
        <p class="tagline">A secret pantry for your treasured video lessons</p>
      </div>
    </div>
    <button id="installBtn" class="btn secondary" hidden>Install</button>
  </header>

  <main class="container">
    <section class="card intro-card">
      <h2>Welcome back to the kitchen</h2>
      <p>Tap around the recipe box artwork to find the hidden latch. Once inside, you can stash the cooking videos that inspire you, knowing they stay private and encrypted on this device.</p>
      <p class="hint">Hint: left hinge, right hinge, then the brass label unlock the secret door.</p>
      <div id="status" class="status" role="status" aria-live="polite"></div>
    </section>

    <section id="vaultPanel" class="card vault" hidden>
      <div class="vault-header">
        <div>
          <h2>Video Pantry</h2>
          <p class="vault-subtitle">Encrypted and tucked safely inside your recipe box</p>
        </div>
        <button id="lockBtn" class="btn subtle" type="button">Lock</button>
      </div>

      <form id="addLinkForm" class="stack" autocomplete="off">
        <div class="field">
          <label for="videoTitle">Video title</label>
          <input id="videoTitle" name="videoTitle" type="text" placeholder="Sourdough folding masterclass" required>
        </div>
        <div class="field">
          <label for="videoUrl">Video link</label>
          <input id="videoUrl" name="videoUrl" type="url" placeholder="https://example.com/watch?v=…" required>
        </div>
        <div class="field">
          <label for="videoNotes">Notes <span class="muted">(optional)</span></label>
          <textarea id="videoNotes" name="videoNotes" rows="3" placeholder="Why this video matters"></textarea>
        </div>
        <button class="btn primary" type="submit" id="saveLinkBtn">Save video link</button>
      </form>

      <div id="vaultStatus" class="status" role="status" aria-live="polite"></div>

      <ul id="videoList" class="video-list" aria-live="polite"></ul>
      <p id="emptyVault" class="empty">No videos saved yet. Add your first one above.</p>
    </section>
  </main>

  <footer class="app-footer">
    <small>Encrypted vault · Works offline · Guarded by your secret passphrase</small>
  </footer>

  <dialog id="passwordDialog" aria-modal="true">
    <form id="passwordForm" method="dialog">
      <h2 id="passwordDialogTitle">Unlock the recipe box</h2>
      <p id="passwordDialogDescription">Enter the secret password to reveal your encrypted video pantry.</p>
      <label class="field">Password
        <input id="passwordInput" name="password" type="password" required autocomplete="current-password">
      </label>
      <label class="field" id="confirmPasswordWrap" hidden>Confirm password
        <input id="confirmPasswordInput" name="confirmPassword" type="password" autocomplete="new-password">
      </label>
      <menu>
        <button type="button" class="btn subtle" id="cancelPasswordBtn">Cancel</button>
        <button type="submit" class="btn primary" id="passwordSubmitBtn">Unlock</button>
      </menu>
      <p id="passwordError" class="status error" role="alert"></p>
    </form>
  </dialog>

  <script src="js/idb-keyval.js"></script>
  <script src="js/app.js" type="module"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
